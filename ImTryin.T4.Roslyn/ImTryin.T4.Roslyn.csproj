<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>netstandard2.0</TargetFramework>
    <Company>ImTryin</Company>
    <Product>ImTryin.T4</Product>
    <Authors>imlex</Authors>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <SuppressDependenciesWhenPacking>true</SuppressDependenciesWhenPacking>
    <DevelopmentDependency>true</DevelopmentDependency>
    <GeneratePackageOnBuild>true</GeneratePackageOnBuild>
    <PackageProjectUrl>https://github.com/imlex/ImTryin.T4</PackageProjectUrl>
    <RepositoryUrl>https://github.com/imlex/ImTryin.T4</RepositoryUrl>
    <RepositoryType>git</RepositoryType>
    <PackageTags>Code Generation T4 Text Templates Roslyn</PackageTags>
    <Description>Boilerplate for using Roslyn within T4 text templates. You can generate code depending on code of current project. See https://github.com/imlex/ImTryin.T4/blob/master/ImTryin.T4.Roslyn.EfTest/TestDbContext.generated.tt for example.</Description>
  </PropertyGroup>

  <ItemGroup>
    <None Include="build\ImTryin.T4.Roslyn.targets" Pack="true" PackagePath="build\">
      <CopyToOutputDirectory>Never</CopyToOutputDirectory>
    </None>
    <None Include="buildMultiTargeting\ImTryin.T4.Roslyn.targets" Pack="true" PackagePath="buildMultiTargeting\">
      <CopyToOutputDirectory>Never</CopyToOutputDirectory>
    </None>
    <None Include="content\_DbContext.generated.tt" Pack="true" PackagePath="content\">
      <CopyToOutputDirectory>Never</CopyToOutputDirectory>
    </None>
    <None Include="Templates\Includes\Autogenerated.ttinclude" Pack="true" PackagePath="Templates\Includes\">
      <CopyToOutputDirectory>Never</CopyToOutputDirectory>
    </None>
    <None Include="Templates\Includes\Roslyn.Utility.ttinclude" Pack="true" PackagePath="Templates\Includes\">
      <CopyToOutputDirectory>Never</CopyToOutputDirectory>
    </None>
    <None Include="bin\Microsoft.CodeAnalysis.Workspaces.dll" Pack="true" PackagePath="Microsoft.CodeAnalysis.3.4.0.Merged\">
      <CopyToOutputDirectory>Never</CopyToOutputDirectory>
    </None>
  </ItemGroup>

  <ItemGroup>
    <PackageReference Include="ILRepack" Version="2.0.18" PrivateAssets="all" />
    <PackageReference Include="Microsoft.CodeAnalysis.CSharp.Workspaces" Version="3.4.0" PrivateAssets="all" />
    <PackageReference Include="Microsoft.CodeAnalysis.Workspaces.MSBuild" Version="3.4.0" PrivateAssets="all" />
  </ItemGroup>

  <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
    <Exec Command="$(ILRepack) /parallel /out:bin\Microsoft.CodeAnalysis.Workspaces.dll /allowDup:Microsoft.CodeAnalysis.FlowAnalysis.ControlFlowGraphExtensions $(NugetPackageRoot)Microsoft.CodeAnalysis.Workspaces.Common\3.4.0\lib\netstandard2.0\Microsoft.CodeAnalysis.Workspaces.dll $(NugetPackageRoot)Microsoft.CodeAnalysis.Common\3.4.0\lib\netstandard2.0\Microsoft.CodeAnalysis.dll $(NugetPackageRoot)Microsoft.CodeAnalysis.CSharp\3.4.0\lib\netstandard2.0\Microsoft.CodeAnalysis.CSharp.dll $(NugetPackageRoot)Microsoft.CodeAnalysis.CSharp.Workspaces\3.4.0\lib\netstandard2.0\Microsoft.CodeAnalysis.CSharp.Workspaces.dll $(NugetPackageRoot)Microsoft.CodeAnalysis.Workspaces.MSBuild\3.4.0\lib\net472\Microsoft.CodeAnalysis.Workspaces.MSBuild.dll $(NugetPackageRoot)System.Buffers\4.4.0\lib\netstandard2.0\System.Buffers.dll $(NugetPackageRoot)System.Collections.Immutable\1.5.0\lib\netstandard2.0\System.Collections.Immutable.dll $(NugetPackageRoot)System.Composition.AttributedModel\1.0.31\lib\netstandard1.0\System.Composition.AttributedModel.dll $(NugetPackageRoot)System.Composition.Convention\1.0.31\lib\netstandard1.0\System.Composition.Convention.dll $(NugetPackageRoot)System.Composition.Hosting\1.0.31\lib\netstandard1.0\System.Composition.Hosting.dll $(NugetPackageRoot)System.Composition.Runtime\1.0.31\lib\netstandard1.0\System.Composition.Runtime.dll $(NugetPackageRoot)System.Composition.TypedParts\1.0.31\lib\netstandard1.0\System.Composition.TypedParts.dll $(NugetPackageRoot)System.Memory\4.5.3\lib\netstandard2.0\System.Memory.dll $(NugetPackageRoot)System.Numerics.Vectors\4.4.0\lib\netstandard2.0\System.Numerics.Vectors.dll $(NugetPackageRoot)System.ObjectModel\4.3.0\lib\netstandard1.3\System.ObjectModel.dll $(NugetPackageRoot)System.Reflection.Emit\4.3.0\lib\netstandard1.3\System.Reflection.Emit.dll $(NugetPackageRoot)System.Reflection.Emit.ILGeneration\4.3.0\lib\netstandard1.3\System.Reflection.Emit.ILGeneration.dll $(NugetPackageRoot)System.Reflection.Emit.Lightweight\4.3.0\lib\netstandard1.3\System.Reflection.Emit.Lightweight.dll $(NugetPackageRoot)System.Reflection.Metadata\1.6.0\lib\netstandard2.0\System.Reflection.Metadata.dll $(NugetPackageRoot)System.Reflection.TypeExtensions\4.3.0\lib\netstandard1.5\System.Reflection.TypeExtensions.dll $(NugetPackageRoot)System.Runtime.CompilerServices.Unsafe\4.5.2\lib\netstandard2.0\System.Runtime.CompilerServices.Unsafe.dll $(NugetPackageRoot)System.Text.Encoding.CodePages\4.5.1\lib\netstandard2.0\System.Text.Encoding.CodePages.dll $(NugetPackageRoot)System.Threading\4.3.0\lib\netstandard1.3\System.Threading.dll $(NugetPackageRoot)System.Threading.Tasks.Extensions\4.5.3\lib\netstandard2.0\System.Threading.Tasks.Extensions.dll" />
<!--
$(NugetPackageRoot)System.Linq\4.3.0\lib\netstandard1.6\System.Linq.dll $(NugetPackageRoot)System.Linq.Expressions\4.3.0\lib\netstandard1.6\System.Linq.Expressions.dll
-->
  </Target>

</Project>